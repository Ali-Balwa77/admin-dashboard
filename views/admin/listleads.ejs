<!doctype html>
<html lang="en">

    <head>
    
        <meta charset="utf-8">
        <title>Datatable | Dhairya - Admin & Dashboard Template</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta content="Premium Multipurpose Admin & Dashboard Template" name="description">
        <meta content="Themesbrand" name="author">
        <!-- App favicon -->
        <link rel="shortcut icon" href="assets/images/favicon.ico">
    
        <!-- DataTables -->
        <link href="assets/css/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css">
        <link href="assets/css/buttons.bootstrap4.min.css" rel="stylesheet" type="text/css">
    
        <!-- Responsive datatable examples -->
        <link href="assets/css/responsive.bootstrap4.min.css" rel="stylesheet" type="text/css">
    
        <!-- Bootstrap Css -->
        <link href="assets/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css">
        <!-- Icons Css -->
        <link href="assets/css/materialdesignicons.min.css" rel="stylesheet" type="text/css">
        <!-- App Css-->
        <link href="assets/css/app.min.css" id="app-style" rel="stylesheet" type="text/css">
        <style>
            .actions{
                height: 40px;
                display: grid;
                grid-template-columns: 50% 50%;
            }
            .editIcon{
                height: 100%;
                padding: auto;
                justify-self: center;
                color: green;
                font-size: 180%;
                cursor: pointer;
                transition: 0.2s;
            }
            .editIcon:hover{
                font-size: 200%;
            }
            .deleteIcon {
                height: 100%;
                padding: auto;
                justify-self: center;
                color: red;
                font-size: 180%;
                cursor: pointer;
                transition: 0.2s;
                
            }
            .deleteIcon:hover{
                font-size: 200%;
            }
            #asterisk{
                color: red;
            }
        </style>
    </head>
    
    <body data-sidebar="dark">
        
        <!-- Begin page -->
        <div id="layout-wrapper">

                                    
            <%- include ('header') -%>
      
            <%- include ('sidebar') -%>


            <!-- ============================================================== -->
            <!-- Start right Content here -->
            <!-- ============================================================== -->
            <!-- <div class="main-content">

                <div class="page-content">
                    <div class="container-fluid"> -->

                        <!-- start page title -->
                         <div class="page-title-box">
                            <div class="row align-items-center">
                                <div class="col-md-8">
                                    <h6 class="page-title">Manage Users</h6>
                                    <ol class="breadcrumb m-0">
                                        <li class=""><a href="/listallleads">Dashboard</a></li>
                                        <li class="active" aria-current="page">Manage Users</li>
                                    </ol>
                                </div>
                                <div class="col-md-4">
                                    <div class="float-end d-none d-md-block">
                                        <div class="dropdown"> -->
                                            <!-- <button type="button" class="btn btn-primary waves-effect waves-light" id="sa-basic">Click me</button> -->
                                            <!-- <button class="btn btn-primary  dropdown-toggle" type="button" id="dropdownMenuButton" 
                                            data-bs-toggle="modal" data-bs-target=".addAdmin"
                           
                                             aria-expanded="false">
                                                <i class="mdi mdi-database-plus-outline"></i> Add
                                            </button>

                                              <div class="row">

                            <div class="modal fade bs-example-modal-center addAdmin" tabindex="-1" role="dialog"
                                    aria-labelledby="mySmallModalLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-lg modal-dialog-centered">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title">Add Client</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                    aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <form class="row g-3 needs-validation" id="editForm" novalidate="" method="post" action="/clientApi/manageUser/addClient">
                                                    <input type="hidden" id="superuserIdInput" name="clientSuperuserid" 
                                                    value='<%= user[0].client_Id %>'/>
                                                    
                                                    <div class="row mb-3 my-4">
                                                        <label for="clientName" class="col-sm-2 col-form-label">Name
                                                            <span id="asterisk">*</span>
                                                        </label>
                                                        <div class="col-sm-10">
                                                            <input class="form-control"
                                                           
                                                            name="clientName" id="clientName" type="text" 
                                                             >
                                                        </div>
                                                    </div>
                                                    
                                                
                                                    <div class="row mb-3">
                                                        <label for="clientEmail" class="col-sm-2 col-form-label">Email
                                                            <span id="asterisk">*</span>
                                                        </label>
                                                        <div class="col-sm-10">
                                                            <input class="form-control"
                                                           
                                                            name="clientEmail" id="clientEmail" type="email"  >
                                                        </div>
                                                    </div>
                                                 
                                                    <div class="row mb-3">
                                                        <label for="clientPassword" class="col-sm-2 col-form-label">Password
                                                            <span id="asterisk">*</span>
                                                        </label>
                                                        <div class="col-sm-10">
                                                            <input class="form-control"
                                                           
                                                            name="clientPassword" id="clientPassword" type="text" 
                                                             >
                                                        </div>
                                                    </div>

                                                    <div class="row mb-3">
                                                        <label for="clientRepeatPassword" class="col-sm-2 col-form-label">Repeat Password
                                                            <span id="asterisk">*</span>
                                                        </label>
                                                        <div class="col-sm-10">
                                                            <input class="form-control"
                                                           
                                                            name="clientRepeatPassword" id="clientRepeatPassword" type="text" 
                                                             >
                                                        </div>
                                                    </div>

                                                    <div class="row mb-3">
                                                        <label for="clientPhoneNumber" class="col-sm-2 col-form-label">Phone Number 
                                                            
                                                        </label>
                                                        <div class="col-sm-10">
                                                            <input class="form-control"
                                                          
                                                            name="clientPhoneNumber" id="clientPhoneNumber" type="text"  >
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                    <div class="mb-3">
                                                        <label class="form-label mb-3 d-flex"> Status <span id="asterisk">*</span></label>
                                                        <div class="form-check form-check-inline">
                                                            <input type="radio" id="clientStatusCustomRadio1" value=1 name="clientStatus" class="form-check-input">
                                                            <label class="form-check-label" for="clientStatusCustomRadio1">Active</label>
                                                        </div>
                                                        <div class="form-check form-check-inline">
                                                            <input type="radio" id="clientStatusCustomRadio2" value=0 name="clientStatus" class="form-check-input">
                                                            <label class="form-check-label" for="clientStatusCustomRadio2">Inactive</label>
                                                        </div>
                                                    </div></div>
                                                    <div class="col-12">
                                                        <button class="btn btn-primary"  type="submit">Add user</button>
                                                    </div>  
                                                </form>
                                                              
                                         
                                            </div>
                                        </div> -->
                                        <!-- /.modal-content -->
                                    <!-- </div> -->
                                    <!-- /.modal-dialog -->
                                <!-- </div> -->
                                <!-- /.modal -->
                            <!-- </div> -->

                                        <!-- </div>
                                    </div>
                                </div>
                            </div>
                        </div> -->
                        <!-- end page title -->


                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        
                                       

                                        <h4 class="card-title">Manage Leads</h4>
                                        <p class="card-title-desc">The Listing of all Leads are here
                                        </p>

                                        <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                            <thead>
                                                <tr>
                                                    <th>id</th>
                                                    <th>Fname</th>
                                                    <th>Lname</th>
                                                    <th>Email</th>
                                                    <th>Countrycode</th>
                                                    <th>Postcode</th>
                                                    <th>Ownerhome</th>
                                                    <th>Latitude</th>
                                                    <th>Longitude</th>
                                                    <th>Movingownhome</th>
                                                    <th>Doyouplantomove</th>
                                                    <th>Residentialstatus</th>
                                                    <th>Status</th>
                                                    <th>Updateat</th>
                                                    <th>Createat</th>
                                                </tr>
                                            </thead>


                                            <tbody>
                                                <% for (var i= 0; i<users.length; i++) {
                                                    %>
                                                <tr>
                                                    <td><%- i+1 -%></td>
                                                    <td><%- users[i].client_Name -%></td>
                                                    <td><%- users[i].client_Email -%></td>
                                                    <td><%- users[i].client_Phone -%></td>
                                                    
                                                    <td><%= new Date(users[i].client_CreateAt).toISOString().
                                                        replace(/T/, ' ').      // replace T with a space
                                                        replace(/\..+/, '') %></td>
                                                    <td>
                                                        <%if(users[i].client_Status === 1) {%><span class="badge bg-success">Active</span><%}%>
                                                        <%if(users[i].client_Status === 0) {%><span class="badge bg-danger">Inactive</span><%}%>
                                                    </td>
                                                    <!-- <td><%- users[i].password -%></td> -->
                                                    <td>
                                                        <div class="actions" >
                                                            <a href="#editForm"  class=" editIcon mdi mdi-lead-pencil"
                                                        value = "<%= users[i].client_Id %>"
                                                        data-bs-toggle="modal" data-bs-target=".updateData"
                                                        onclick="editData(event)"
                                                    ></a>
                                                            
                                                            <i class=" deleteIcon mdi mdi-minus-circle" value = "<%= users[i].client_Id %>"
                                                                onclick="deleteData(event)"></i>
                                                            <script type="text/javascript">
                                                                function deleteData(event){
                                                               
                                                                    const data = { id: event.target.getAttribute('value') };
                                                                    fetch('/clientApi/manageUser/deleteUser', {
                                                                        method: 'POST', // or 'PUT'
                                                                        headers: {
                                                                            'Content-Type': 'application/json',
                                                                        },
                                                                        body: JSON.stringify(data),
                                                                        })
                                                                        .then(response => response.json())
                                                                        .then(data => {
                                                                        console.log('Success:', data);
                                                                        })
                                                                        .catch((error) => {
                                                                        console.error('Error:', error);
                                                                        });    
                                                                        
                                                                        window.location.reload();
                                                                    }
                                                            </script>
                                                        </div>
                                                       
                                                    </td>
                                                </tr> <% } %>
                                         
                                            </tbody>
                                        </table>
                                    </div>
                                    </div>
                                </div>
                            </div> <!-- end col -->
                        </div> <!-- end row -->


                        <div class="row">

                            <div class="modal fade bs-example-modal-center updateData" tabindex="-1" role="dialog"
                                    aria-labelledby="mySmallModalLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-lg modal-dialog-centered">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title">Update Client Data</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                    aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <form class="row g-3 needs-validation" id="editForm" novalidate="" method="post" action="/clientApi/manageUser/update">
                                                    <input type="hidden" id="idInput" name="id" value=""/>

                                                    <div class="row mb-3 my-4">
                                                        <label for="client_name" class="col-sm-2 col-form-label">Name
                                                            <span id="asterisk">*</span>
                                                        </label>
                                                        <div class="col-sm-10">
                                                            <input class="form-control"
                                                           
                                                            name="client_name" id="client_name" type="text" 
                                                             >
                                                        </div>
                                                    </div>
                                                    
                                                
                                                    <div class="row mb-3">
                                                        <label for="client_email" class="col-sm-2 col-form-label">Email
                                                            <!-- <span id="asterisk">*</span> -->
                                                        </label>
                                                        <div class="col-sm-10">
                                                            <input class="form-control"
                                                            disabled="true"
                                                            name="client_email" id="client_email" type="text"  >
                                                        </div>
                                                    </div>
                                                 
                                                    <div class="row mb-3">
                                                        <label for="client_phoneNumber" class="col-sm-2 col-form-label">Phone Number 
                                                            
                                                        </label>
                                                        <div class="col-sm-10">
                                                            <input class="form-control"
                                                          
                                                            name="client_phoneNumber" id="client_phoneNumber" type="text"  >
                                                        </div>
                                                    </div>

                                                    
                                                    <div class="mb-3">
                                                        <label class="form-label mb-3 d-flex"> Status <span id="asterisk">*</span></label>
                                                        <div class="form-check form-check-inline">
                                                            <input type="radio" id="statusCustomRadio1" value=1 name="clientstatus" class="form-check-input">
                                                            <label class="form-check-label" for="statusCustomRadio1">Active</label>
                                                        </div>
                                                        <div class="form-check form-check-inline">
                                                            <input type="radio" id="statusCustomRadio2" value=0 name="clientstatus" class="form-check-input">
                                                            <label class="form-check-label" for="statusCustomRadio2">Inactive</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-12">
                                                        <button class="btn btn-primary" type="submit">Update</button>
                                                    </div>  
                                                </form>
                                            </div>
                                        </div>
                                        <!-- /.modal-content -->
                                    </div>
                                    <!-- /.modal-dialog -->
                                </div>
                                <!-- /.modal -->
                            </div>

                            <script>
                                    function editData(event){
                                        const data = { id: event.target.getAttribute('value') };
                                        // console.log(data,"this is data")
                                        let resData;
                                        fetch('/clientApi/manageUser/edit', {
                                            method: 'POST', // or 'PUT'
                                            headers: {
                                                'Content-Type': 'application/json',
                                            },
                                            body: JSON.stringify(data),
                                            })
                                            .then(response => response.json())
                                            .then(data => {
                                            console.log('Success:',data.id);
                                            
                                            const name = document.getElementById("client_name");
                                            name.value = data.client_Name;
                                            name.disabled = false;

                                            const email = document.getElementById("client_email");
                                            email.value = data.client_Email;

                                            const phoneNumber = document.getElementById("client_phoneNumber");
                                            phoneNumber.value = data.client_Phone;
                                            // email.disabled = false;
                                            const active = document.getElementById("statusCustomRadio1")
                                            const inactive = document.getElementById("statusCustomRadio2")
                                            if(data.client_Status === 1) active.checked = "true"
                                            if(data.client_Status === 0) inactive.checked = "true"
                                            const id = document.getElementById("idInput");
                                            id.value = data.client_Id;
                                            

                                            })
                                            .catch((error) => {
                                            console.error('Error:', error);
                                            });                                             
                                }

                                function handleChange(event){
                                    console.log(event.target.value)
                                }
                            </script>


                        
                    </div> <!-- container-fluid -->
                    
                </div>
                
                <!-- End Page-content -->

                
                <footer class="footer">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-12">
                                © <script>document.write(new Date().getFullYear())</script> Veltrix<span class="d-none d-sm-inline-block"> - Crafted with <i class="mdi mdi-heart text-danger"></i> by Themesbrand.</span>
                            </div>
                        </div>
                    </div>
                </footer>


            </div>
            <!-- end main content-->

        </div>
        <!-- END layout-wrapper -->

        <!-- Right Sidebar -->
        <div class="right-bar">
            <div data-simplebar class="h-100">
                <div class="rightbar-title px-3 py-4">
                    <a href="javascript:void(0);" class="right-bar-toggle float-end">
                        <i class="mdi mdi-close noti-icon"></i>
                    </a>
                    <h5 class="m-0">Settings</h5>
                </div>

                <!-- Settings -->
                <hr class="mt-0" />
                <h6 class="text-center">Choose Layouts</h6>

                <div class="p-4">
                    <div class="mb-2">
                        <img src="assets/images/layouts/layout-1.jpg" class="img-fluid img-thumbnail" alt="">
                    </div>
                    <div class="form-check form-switch mb-3">
                        <input type="checkbox" class="form-check-input theme-choice" id="light-mode-switch" checked />
                        <label class="form-check-label" for="light-mode-switch">Light Mode</label>
                    </div>
    
                    <div class="mb-2">
                        <img src="assets/images/layouts/layout-2.jpg" class="img-fluid img-thumbnail" alt="">
                    </div>
                    <div class="form-check form-switch mb-3">
                        <input type="checkbox" class="form-check-input theme-choice" id="dark-mode-switch" data-bsStyle="assets/css/bootstrap-dark.min.css" 
                            data-appStyle="assets/css/app-dark.min.css" />
                        <label class="form-check-label" for="dark-mode-switch">Dark Mode</label>
                    </div>
    
                    <div class="mb-2">
                        <img src="assets/images/layouts/layout-3.jpg" class="img-fluid img-thumbnail" alt="">
                    </div>
                    <div class="form-check form-switch mb-5">
                        <input type="checkbox" class="form-check-input theme-choice" id="rtl-mode-switch" data-appStyle="assets/css/app-rtl.min.css" />
                        <label class="form-check-label" for="rtl-mode-switch">RTL Mode</label>
                    </div>
                    <div class="d-grid">
                        <a href="https://1.envato.market/grNDB" class="btn btn-primary mt-3" target="_blank"><i class="mdi mdi-cart me-1"></i> Purchase Now</a>
                    </div>
                </div>

            </div> <!-- end slimscroll-menu-->
        </div>
        <!-- /Right-bar -->

        <!-- Right bar overlay-->
        <div class="rightbar-overlay"></div>

        
        <!-- JAVASCRIPT -->
        <script src="assets/libs/jquery/jquery.min.js"></script>
        <script src="assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
        <script src="assets/libs/metismenu/metisMenu.min.js"></script>
        <script src="assets/libs/simplebar/simplebar.min.js"></script>
        <script src="assets/libs/node-waves/waves.min.js"></script>

        <!-- Required datatable js -->
        <script src="assets/libs/datatables.net/js/jquery.dataTables.min.js"></script>
        <script src="assets/libs/datatables.net-bs4/js/dataTables.bootstrap4.min.js"></script>
        <!-- Buttons examples -->
        <script src="assets/libs/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
        <script src="assets/libs/datatables.net-buttons-bs4/js/buttons.bootstrap4.min.js"></script>
        <script src="assets/libs/jszip/jszip.min.js"></script>
        <script src="assets/libs/pdfmake/build/pdfmake.min.js"></script>
        <script src="assets/libs/pdfmake/build/vfs_fonts.js"></script>
        <script src="assets/libs/datatables.net-buttons/js/buttons.html5.min.js"></script>
        <script src="assets/libs/datatables.net-buttons/js/buttons.print.min.js"></script>
        <script src="assets/libs/datatables.net-buttons/js/buttons.colVis.min.js"></script>
        <!-- Responsive examples -->
        <script src="assets/libs/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
        <script src="assets/libs/datatables.net-responsive-bs4/js/responsive.bootstrap4.min.js"></script>

        <!-- Sweet Alerts js -->
        // <script src="assets/libs/sweetalert2/sweetalert2.min.js"></script>

        <!-- Sweet alert init js-->
        // <script src="assets/js/pages/sweet-alerts.init.js"></script>

        <!-- Datatable init js -->
        <script src="assets/js/pages/datatables.init.js"></script> 

        <script src="assets/js/app.js"></script>

    </body>
</html>
